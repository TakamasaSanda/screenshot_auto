import pyautogui
import webbrowser
import time
import os
import shutil
import datetime
import pandas as pd
import csv
import pprint
from selenium import webdriver
import schedule



def total_work():
    folder_name = "screeenshot_" + \
        str(datetime.datetime.now().strftime("%Y%m%d%H%M"))
    path = "/Users/takamasa/Downloads/shot/A_screen_ranking_Z/" + folder_name

    os.makedirs(path, exist_ok=True)


    os.makedirs(path  + "/yahooranking" , exist_ok=True)
    df = pd.read_csv('yahooranking.csv', header=None, names=['yahooranking'])
    for line in df['yahooranking']:
        f = df['yahooranking']
        webbrowser.open(f"{line}")
        timi = datetime.datetime.now()
        timin = str(timi)
        time.sleep(4)
        file_name = "screeenshot:" + timin + ".png"
        s = pyautogui.screenshot()
        s.save(path  + "/yahooranking/" + file_name)
    # 列ごと

    os.makedirs(path  + "/paypaycategory" , exist_ok=True)
    df = pd.read_csv('paypaycategory.csv', header=None, names=['paypaycategory'])
    for line in df['paypaycategory']:
        f = df['paypaycategory']
        webbrowser.open(f"{line}")
        timi = datetime.datetime.now()
        timin = str(timi)
        time.sleep(3)
        file_name = "screeenshot:" + timin + ".png"
        s = pyautogui.screenshot()
        s.save(path  + "/paypaycategory/" + file_name)

    os.makedirs(path  + "/paypaycita01-2" , exist_ok=True)
    df = pd.read_csv('paypaycita01-2.csv', header=None, names=['paypaycita01-2'])
    for line in df['paypaycita01-2']:
        f = df['paypaycita01-2']
        webbrowser.open(f"{line}")
        timi = datetime.datetime.now()
        timin = str(timi)
        time.sleep(3)
        file_name = "screeenshot:" + timin + ".png"
        s = pyautogui.screenshot()
        s.save(path  + "/paypaycita01-2/" + file_name)

    os.makedirs(path  + "/paypaycitaeb01-set" , exist_ok=True)
    df = pd.read_csv('paypaycitaeb01-set.csv', header=None, names=['paypaycitaeb01-set'])
    for line in df['paypaycitaeb01-set']:
        f = df['paypaycitaeb01-set']
        webbrowser.open(f"{line}")
        timi = datetime.datetime.now()
        timin = str(timi)
        time.sleep(3)
        file_name = "screeenshot:" + timin + ".png"
        s = pyautogui.screenshot()
        s.save(path  + "/paypaycitaeb01-set/" + file_name)


    os.makedirs(path  + "/paypaycitaeb01-set2" , exist_ok=True)
    df = pd.read_csv('paypaycitaeb01-set2.csv', header=None, names=['paypaycitaeb01-set2'])
    for line in df['paypaycitaeb01-set2']:
        f = df['paypaycitaeb01-set2']
        webbrowser.open(f"{line}")
        timi = datetime.datetime.now()
        timin = str(timi)
        time.sleep(3)
        file_name = "screeenshot:" + timin + ".png"
        s = pyautogui.screenshot()
        s.save(path  + "/paypaycitaeb01-set2/" + file_name)




    os.makedirs(path  + "/paypaycitaeb01" , exist_ok=True)
    df = pd.read_csv('paypaycitaeb01.csv', header=None, names=['paypaycitaeb01'])
    for line in df['paypaycitaeb01']:
        f = df['paypaycitaeb01']
        webbrowser.open(f"{line}")
        timi = datetime.datetime.now()
        timin = str(timi)
        time.sleep(3)
        file_name = "screeenshot:" + timin + ".png"
        s = pyautogui.screenshot()
        s.save(path  + "/paypaycitaeb01/" + file_name)

    os.makedirs(path  + "/paypayCitaebcc" , exist_ok=True)
    df = pd.read_csv('paypayCitaebcc.csv', header=None, names=['paypayCitaebcc'])
    for line in df['paypayCitaebcc']:
        f = df['paypayCitaebcc']
        webbrowser.open(f"{line}")
        timi = datetime.datetime.now()
        timin = str(timi)
        time.sleep(3)
        file_name = "screeenshot:" + timin + ".png"
        s = pyautogui.screenshot()
        s.save(path  + "/paypayCitaebcc/" + file_name)

    os.makedirs(path  + "/paypayeb01-01" , exist_ok=True)
    df = pd.read_csv('paypayeb01-01.csv', header=None, names=['paypayeb01-01'])
    for line in df['paypayeb01-01']:
        f = df['paypayeb01-01']
        webbrowser.open(f"{line}")
        timi = datetime.datetime.now()
        timin = str(timi)
        time.sleep(3)
        file_name = "screeenshot:" + timin + ".png"
        s = pyautogui.screenshot()
        s.save(path  + "/paypayeb01-01/" + file_name)

    os.makedirs(path  + "/paypaySolar" , exist_ok=True)
    df = pd.read_csv('paypaySolar.csv', header=None, names=['paypaySolar'])
    for line in df['paypaySolar']:
        f = df['paypaySolar']
        webbrowser.open(f"{line}")
        timi = datetime.datetime.now()
        timin = str(timi)
        time.sleep(3)
        file_name = "screeenshot:" + timin + ".png"
        s = pyautogui.screenshot()
        s.save(path  + "/paypaySolar/" + file_name)

    os.makedirs(path  + "/paypaySP" , exist_ok=True)
    df = pd.read_csv('paypaySP.csv', header=None, names=['paypaySP'])
    for line in df['paypaySP']:
        f = df['paypaySP']
        webbrowser.open(f"{line}")
        timi = datetime.datetime.now()
        timin = str(timi)
        time.sleep(3)
        file_name = "screeenshot:" + timin + ".png"
        s = pyautogui.screenshot()
        s.save(path  + "/paypaySP/" + file_name)

    os.makedirs(path  + "/paypaySP01set" , exist_ok=True)
    df = pd.read_csv('paypaySP01set.csv', header=None, names=['paypaySP01set'])
    for line in df['paypaySP01set']:
        f = df['paypaySP01set']
        webbrowser.open(f"{line}")
        timi = datetime.datetime.now()
        timin = str(timi)
        time.sleep(3)
        file_name = "screeenshot:" + timin + ".png"
        s = pyautogui.screenshot()
        s.save(path  + "/paypaySP01set/" + file_name)

    os.makedirs(path  + "/paypaySPset2" , exist_ok=True)
    df = pd.read_csv('paypaySPset2.csv', header=None, names=['paypaySPset2'])
    for line in df['paypaySPset2']:
        f = df['paypaySPset2']
        webbrowser.open(f"{line}")
        timi = datetime.datetime.now()
        timin = str(timi)
        time.sleep(3)
        file_name = "screeenshot:" + timin + ".png"
        s = pyautogui.screenshot()
        s.save(path  + "/paypaySPset2/" + file_name)














    os.makedirs(path  + "/太陽光発電機・ソーラーパネル" , exist_ok=True)
    df = pd.read_csv('太陽光発電機・ソーラーパネル.csv', header=None, names=['太陽光発電機・ソーラーパネル'])
    for line in df['太陽光発電機・ソーラーパネル']:
        f = df['太陽光発電機・ソーラーパネル']
        webbrowser.open(f"{line}")
        timi = datetime.datetime.now()
        timin = str(timi)
        time.sleep(3)
        file_name = "screeenshot:" + timin + ".png"
        s = pyautogui.screenshot()
        s.save(path  + "/太陽光発電機・ソーラーパネル/" + file_name)
    #楽天市場トップ  >  ランキングトップ  >  花・ガーデン・DIY  >  DIY・工具  >  電動工具本体  >  発電機・ポータブル電源  >  太陽光発電機・ソーラーパネル

    os.makedirs(path  + "/車用品・バイク用品>その他" , exist_ok=True)
    df = pd.read_csv('車用品・バイク用品>その他.csv', header=None, names=['車用品・バイク用品>その他'])
    for line in df['車用品・バイク用品>その他']:
        f = df['車用品・バイク用品>その他']
        webbrowser.open(f"{line}")
        timi = datetime.datetime.now()
        timin = str(timi)
        time.sleep(3)
        file_name = "screeenshot:" + timin + ".png"
        s = pyautogui.screenshot()
        s.save(path  + "/車用品・バイク用品>その他/" + file_name)
    #楽天市場トップ  >  ランキングトップ  >  車用品・バイク用品  >  その他


    os.makedirs(path  + "/車用品・バイク用品>車用品>その他" , exist_ok=True)
    df = pd.read_csv('車用品・バイク用品>車用品>その他.csv', header=None, names=['車用品・バイク用品>車用品>その他'])
    for line in df['車用品・バイク用品>車用品>その他']:
        f = df['車用品・バイク用品>車用品>その他']
        webbrowser.open(f"{line}")
        timi = datetime.datetime.now()
        timin = str(timi)
        time.sleep(3)
        file_name = "screeenshot:" + timin + ".png"
        s = pyautogui.screenshot()
        s.save(path  + "/車用品・バイク用品>車用品>その他/" + file_name)
    #楽天市場トップ  >  ランキングトップ  > 車用品・バイク用品  >  車用品  >  その他



    os.makedirs(path  + "/バッテリー・充電器>ソーラーチャージャー" , exist_ok=True)
    df = pd.read_csv('バッテリー・充電器>ソーラーチャージャー.csv', header=None, names=['バッテリー・充電器>ソーラーチャージャー'])
    for line in df['バッテリー・充電器>ソーラーチャージャー']:
        f = df['バッテリー・充電器>ソーラーチャージャー']
        webbrowser.open(f"{line}")
        timi = datetime.datetime.now()
        timin = str(timi)
        time.sleep(3)
        file_name = "screeenshot:" + timin + ".png"
        s = pyautogui.screenshot()
        s.save(path  + "/バッテリー・充電器>ソーラーチャージャー/" + file_name)
    #楽天市場トップ  >  ランキングトップ  >  スマートフォン・タブレット  >  バッテリー・充電器  >  ソーラーチャージャー




    os.makedirs(path  + "/家電>住宅設備家電>ソーラーパネル" , exist_ok=True)
    df = pd.read_csv('家電>住宅設備家電>ソーラーパネル.csv', header=None, names=["家電>住宅設備家電>ソーラーパネル"])
    for line in df['家電>住宅設備家電>ソーラーパネル']:
        f = df['家電>住宅設備家電>ソーラーパネル']
        webbrowser.open(f"{line}")
        timi = datetime.datetime.now()
        timin = str(timi)
        time.sleep(3)
        file_name = "screeenshot:" + timin + ".png"
        s = pyautogui.screenshot()
        s.save(path  + "/家電>住宅設備家電>ソーラーパネル/" + file_name)

    #楽天市場トップ  >  ランキングトップ  >  家電  >  住宅設備家電  >  ソーラーパネル



    os.makedirs(path  + "/発電機・ポータブル電源>その他" , exist_ok=True)
    df = pd.read_csv('発電機・ポータブル電源>その他.csv', header=None, names=['発電機・ポータブル電源>その他'])
    for line in df['発電機・ポータブル電源>その他']:
        f = df['発電機・ポータブル電源>その他']
        webbrowser.open(f"{line}")
        timi = datetime.datetime.now()
        timin = str(timi)
        time.sleep(3)
        file_name = "screeenshot:" + timin + ".png"
        s = pyautogui.screenshot()
        s.save(path  + "/発電機・ポータブル電源>その他/" + file_name)
    #楽天市場トップ  >  ランキングトップ  >  花・ガーデン・DIY  >  DIY・工具  >  電動工具本体  >  発電機・ポータブル電源  >  その他



    os.makedirs(path  + "/日用品雑貨・文房具・手芸>防災関連グッズ>その他" , exist_ok=True)
    df = pd.read_csv('日用品雑貨・文房具・手芸>防災関連グッズ>その他 .csv', header=None, names=["日用品雑貨・文房具・手芸>防災関連グッズ>その他"])
    for line in df['日用品雑貨・文房具・手芸>防災関連グッズ>その他']:
        f = df['日用品雑貨・文房具・手芸>防災関連グッズ>その他']
        webbrowser.open(f"{line}")
        timi = datetime.datetime.now()
        timin = str(timi)
        time.sleep(3)
        file_name = "screeenshot:" + timin + ".png"
        s = pyautogui.screenshot()
        s.save(path  + "/日用品雑貨・文房具・手芸>防災関連グッズ>その他/" + file_name)
    #楽天市場トップ  >  ランキングトップ  >  日用品雑貨・文房具・手芸  >  防災関連グッズ  >  その他


schedule.every().day.at("09:00").do(total_work)

while True:
    schedule.run_pending()
    time.sleep(1)
